# Title: Predicting body composition and blood pressure in a South African student population 
## Brief Introduction
Most research is conducted in WEIRD (Western, Educated, Industrialised, Rich, and Democratic) countries. Less than 1% of the world's research is conducted in Africa. In this study we wanted to explore which demographic and/or lifestyle factors predict aspects of health, specifically body composition and blood pressure, in a Black South African student population. Once these factors are better understood, they can be used to improve health and identify risk factors in this population. The aim of this study is therefore to determine which demographic and/or lifestyle factors predict body composition and blood pressure in a South African student population.

## Methods
### Data
The African Longitudinal Facial Appearance and Health Study (ALFAH) study was approved by research ethics committees at the Faculties of Health Sciences (259/2016), Natural and Agricultural Sciences (EC160429-024) and Humanities (25309995/ HUM030/0819) at the University of Pretoria, South Africa. Two hundred and seventy-one (N=271) African participants (53.3% male) aged 18 to 29 (mean: 20.79) were recruited for the study from the University of Pretoria and the Sefako Makgatho University, Pretoria, South Africa. Written informed sent was obtained from all participants. Participants were asked to complete a questionnaire, including questions on basic demographic variables, their health, exercise and diet (in the past 7 days). Each participant's body composition (i.e. body weight, percentage body fat, muscle mass etc.) were measured with a Tanita MC 780 MA Segmental Body Composition Analyser; their blood pressure with an automated blood pressure monitor and their standing and sitting height with a wall-mounted stadiometer. The data was stored in a MySQL database (Server version: 8.0.33 MySQL Community Server - GPL).

### Data analyses
The number of missing values were calculated. Four columns and one row with more than 10% missing data (and other unnecesary colums) were dropped from the dataframe. Missing values in 41 numerical variables (range 0.4-6.7% missing) were replaced by the mean and missing values in two categorical variables (1.1-3.0% missing) were replaced by the most common category. The data format was corrected for all remaining variables and the data visualised. The two exercise variables were combined into a single, weighted exercise variable (exercise = moderate exercise + (2 * strenious exercise)), and the 14 food frequency variables were combined into four food indixes: fruit & veg index (fruit juice, fruit and vegetables), carbs index (bread, pap and samp, rice and pasta), dairy index (dairy) and protein index (red meat, chicken, pork, fish and eggs). There were insufficient data for a 'fat' index, but sufficient data to add a junkfood index (take aways and soft drinks). Two standing height variables that were swapped with sitting height, were corrected. Systolic and diastolic blood pressure were kept as seperate variables. The 32 body composition measures were strongly correlated (up to r=1.0). To reduce their dimensions we first dropped the most highly correlated variables (r>0.97) and later included the rest of the variables in a principal component analysis (PCA). The body composition variables were also moderately to strongly correlated with standing height (~r=0.7), sitting height and average grip strength (~r=0.6), so these variables were also included in the body composition PCA. All numerical variables were standardized using MinMax scaling.

Forward Linear Regression, Regression (Decision) tree, Random Forest, Gradient boosting tree and Support Vector Regression were used to predict body composition and blood pressure. Deep learning models were not included due to the limited sample size. The dataset split into training and testing sets using a 80:20 split. Features were selected for forward linear regression based on the strongest individual correlations and the variance inflation factor (VIF) calculated to detect multicolinearity. Regression trees were pruned based on 5 fold cross validated R2 scores. Random forests estimated using a 1000 estimators.  All analyses were performed in Jupyter notebook 6.4.8 using Python 3.9.12 (main, Apr  4 2022, 05:22:27) [MSC v.1916 64 bit (AMD64)].

## Results
The first two body composition principal components (PCs) explained 86.7% of the variance, while a third PC only explained an additional 3.3%. Only the first two PCs were therefore included in downstream analyses. PC1 can be referred to as the fat component, with higher values on this component indicating body types that are higher in body fat & metabolic age and lower in strength, muscle and height. PC2 can be referred to as the muscular component with higher values indicating more muscle, height, and a stronger grip, and lower in body fat. I also examined whether PCA would be a sensible approach for the food frequency data, but even four PCs only explained 53.8% of the data. The food frequency indices were therefore used in subsequent analyses.

### Predicting Body composition:
PC1 (the fat component) was most strongly correlated with sex (r=-0.27), exercise_scaled (r=-0.19) and fruitveg_index_scaled (r=0.10). All the regression models predicted PC1 very poorly. The linear regression and regression tree models produced the highest R2 and lowest MSE (R2=0.04; MSE=0.35). In both cases sex was the only explanatory variable, with women having a higher fat component than men.

PC2 (the muscular component) was most strongly correlated with sex (r=0.32), age_scaled (r=0.17), income (r=0.14) and protein_index_scaled (r=0.12). PC2 was predicted somewhat better than PC1, with the linear regression model producing the highest R2 and lowest MSE (R2=0.24; MSE=0.14). The final linear regression model included sex, age_scaled, income, protein_index_scaled, dairy_scaled and fruitveg_index_scaled. Men had a higher muscular component than women. In addition, older, richer people who consumed more protein, dairy and fruit and vegetables had a higher muscular component. All VIFs were in the acceptable range.

Overall, the regression models did not predict PC1 and PC2 very well. I therefore determined whether individual body composition measures would not be predicted better. The three most useful individual body composition measures from a theoretical perspective are body fat, visceral fat and muscle mass. Of the three muscle mass was the most promising, showing stronger correlations with a variety of directly observable features (sex, standing height etc) and systolic blood pressure. 

Muscle mass was most strong correlated with standing height (r=0.72), sex (r=0.34), income (r=0.14), age_scaled (r=0.14), protein_index_scaled (r=0.13), exercised_scaled (r=0.12) and dairy_scaled (r= 0.10). Linear regression models produced the highest R2 and lowest MSE values. The step 7 linear regression model (standing_height_scaled, sex, income, age_scaled, protein_index_scaled, exercise_scaled, dairy_scaled) produced very similar, but slightly higher R2 and lower MSE (R2=0.63; MSE=20.29) than the step 4 linear regression model (standing_height_scaled, sex, income, age_scaled; R2=0.63; MSE=20.32). I, however, selected the step 4 model because it was simpler and the variables more easily obtainable. Men had a higher muscle mass than women. People with a higher muscle mass were also generally taller, older and have a higher income. All VIFs were in the acceptable range.

Body fat was most strongly correlated with standing_height_scaled (r=-0.44), sex (r=-0.31) and exercise_scaled (r=-0.19). The linear regression model produced the highest R2 and lowest MSE values (R2=0.21; MSE=70.47). The final linear regression model included standing_height_scaled and sex. Women had a higher body fat than men, and shorter people had a higher body fat than taller people. All VIFs were in the acceptable range. All the regression models explained very little variance in visceral fat (Best model R2=0.07; MSE=2.57).

### Predicting Blood Pressure
Systolic blood pressure was most strongly correlated with muscle_mass_scaled (r=0.51), dairy_scaled (r=0.15) and alcohol (r=0.10). The linear regression model produced the highest R2 and lowest MSE (R2=0.26; MSE=91.14). The final linear regression model included muscle_mass_scaled, dairy_scaled, alcohol and junkfood_index_scaled. More muscular people who consumed more dairy, alcohol and junkfood had a higher systolic blood pressure. The removal of one multivariate outlier did not improve the model further. All regression models explained very little variance in diastolic blood pressure (Best model R2=0.07; MSE=86.23)








